  TYPE seq_used_tab IS TABLE OF VARCHAR2(1) INDEX BY BINARY_INTEGER;
                     seq_used   seq_used_tab;
 DECLARE 
                     item_seq NUMBER:=1; 
                     tot_items  NUMBER; 
                     prev_item   VARCHAR(2000):='';
                     c_loop       NUMBER:=1;
                                         
                     
              BEGIN
              
              SELECT count(distinct(order_number)) into tot_items --total number of orders in table
                                    FROM xxat_cm_shpa_intf 
                            WHERE creation_date > sysdate-10 and cm_code='MP_NINGBO' and process_status  not in ('DELETED', 'NOT_PICK_READY')
                                 and order_number is not null  ;
              
              FOR i in 1..tot_items
                 LOOP
                               seq_used(i):=''; -- total number of orders, equal to number of rows in table
                 END LOOP;    
                c_loop:=0;              
              FOR grt_item in (    -- get the Unique Items in desc order count of items
                     SELECT count(distinct(order_number)) , item
                         FROM xxat_cm_shpa_intf 
                            WHERE creation_date > sysdate-10 and cm_code='MP_NINGBO' and process_status != 'NOT_PICK_READY'
                                 and order_number is not null 
                          group by item order by count(distinct(order_number)) desc
                    )
                LOOP                            
                c_loop:=c_loop+1;
                item_seq:=c_loop;
                                          dbms_output.put_line('CLOOP for next item ' ||c_loop );     
                 FOR order_seq IN  -- Now get the orders matchign to the item from outer loop
                         (SELECT item, delivery_number, order_number, load_id, process_status
                                         FROM xxat_cm_shpa_intf 
                                         WHERE  creation_date > sysdate-10 and cm_code='MP_NINGBO' 
                                             and process_status not in ('DELETED', 'NOT_PICK_READY')
                                            AND order_number is not null 
                                            and item = grt_item.item
                                            Order by item, delivery_number )
                   LOOP
                   -- We are updating table, assigning a sequence number to lines in which to be pick released and pick confirmed.

                                           
                           IF prev_item is NULL THEN   -- first time
                              --    prev_item := order_seq.item ;

								item_seq:=c_loop;
                                  IF seq_used(item_seq) is NULL THEN
                                   seq_used(item_seq):='U'; 
                                  ELSE
                                      dbms_output.put_line('Sequence '|| item_seq || ' already used ');
                                     -- Get the first array location which is Unused , from item_seq onwards
                                     FOR j in item_seq+1..tot_items LOOP
                                --        dbms_output.put_line('Look in tarray location '|| j); 
                                       IF seq_used(j) is NULL THEN
                                            seq_used(j):='U'; 
                                            item_seq:=j;
                                            EXIT;
                                       END IF;     
                                     END LOOP ;
                                  END IF;  
                                  seq_used(item_seq):='U';   --used
                                dbms_output.put_line('Item ' ||order_seq.item || ' first = '||item_seq );
                           ELSE -- prev_item =   order_seq.item THEN       
                                  item_seq:=item_seq+6 ;
                                  IF seq_used(item_seq) is NULL THEN
                                   seq_used(item_seq):='U'; 
                                  ELSE
                                      dbms_output.put_line('Sequence '|| item_seq || ' already used ');
                                     -- Get the first array location which is Unused , from item_seq onwards
                                     FOR j in item_seq+1..tot_items LOOP
                              --          dbms_output.put_line('Look in tarray location '|| j); 
                                       IF seq_used(j) is NULL THEN
                                            seq_used(j):='U'; 
                                            item_seq:=j;
                                            EXIT;
                                       END IF;     
                                     END LOOP ;
                                  END IF;  
                                   dbms_output.put_line('Item ' ||order_seq.item || ' seq = '||item_seq );
                              END IF;          
                            prev_item := order_seq.item ;
                             dbms_output.put_line('CLOOP ' ||c_loop );
                             END LOOP;   
                          dbms_output.put_line('CLOOP in outer' ||c_loop );  
                           prev_item :='';   
                  END LOOP;      
            END;